

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>underworld.swarm module &mdash; underworld2  documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="genindex.html"/>
        <link rel="search" title="Search" href="search.html"/>
    <link rel="top" title="underworld2  documentation" href="index.html"/>
        <link rel="up" title="underworld module" href="underworld.html"/>
        <link rel="next" title="underworld.swarm.layouts module" href="underworld.swarm.layouts.html"/>
        <link rel="prev" title="underworld.utils module" href="underworld.utils.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> underworld2
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="underworld.html">underworld module</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="underworld.html#module-summary">Module Summary</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="underworld.html#submodules">submodules:</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="underworld.function.html">underworld.function module</a></li>
<li class="toctree-l4"><a class="reference internal" href="underworld.container.html">underworld.container module</a></li>
<li class="toctree-l4"><a class="reference internal" href="underworld.utils.html">underworld.utils module</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">underworld.swarm module</a></li>
<li class="toctree-l4"><a class="reference internal" href="underworld.mesh.html">underworld.mesh module</a></li>
<li class="toctree-l4"><a class="reference internal" href="underworld.systems.html">underworld.systems module</a></li>
<li class="toctree-l4"><a class="reference internal" href="underworld.conditions.html">underworld.conditions module</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="underworld.html#functions">functions:</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="underworld.html#module-details">Module Details</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="glucifer.html">glucifer module</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">underworld2</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
      
          <li><a href="underworld.html">underworld module</a> &raquo;</li>
      
    <li>underworld.swarm module</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/underworld.swarm.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="underworld-swarm-module">
<h1>underworld.swarm module<a class="headerlink" href="#underworld-swarm-module" title="Permalink to this headline">¶</a></h1>
<p>This module contains routines relating to swarm type objects.</p>
<div class="section" id="module-summary">
<h2>Module Summary<a class="headerlink" href="#module-summary" title="Permalink to this headline">¶</a></h2>
<div class="section" id="submodules">
<h3>submodules:<a class="headerlink" href="#submodules" title="Permalink to this headline">¶</a></h3>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="underworld.swarm.layouts.html">underworld.swarm.layouts module</a></li>
</ul>
</div>
</div>
<div class="section" id="classes">
<h3>classes:<a class="headerlink" href="#classes" title="Permalink to this headline">¶</a></h3>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#underworld.swarm.PopulationControl" title="underworld.swarm.PopulationControl"><code class="xref py py-obj docutils literal"><span class="pre">underworld.swarm.PopulationControl</span></code></a></td>
<td>This class implements swarm population control mechanism.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#underworld.swarm.SwarmVariable" title="underworld.swarm.SwarmVariable"><code class="xref py py-obj docutils literal"><span class="pre">underworld.swarm.SwarmVariable</span></code></a></td>
<td>The SwarmVariable class allows users to add data to swarm particles.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#underworld.swarm.GaussIntegrationSwarm" title="underworld.swarm.GaussIntegrationSwarm"><code class="xref py py-obj docutils literal"><span class="pre">underworld.swarm.GaussIntegrationSwarm</span></code></a></td>
<td>Integration swarm which creates particles within an element at the Gauss points.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#underworld.swarm.VoronoiIntegrationSwarm" title="underworld.swarm.VoronoiIntegrationSwarm"><code class="xref py py-obj docutils literal"><span class="pre">underworld.swarm.VoronoiIntegrationSwarm</span></code></a></td>
<td>Class for an IntegrationSwarm that maps to another Swarm</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#underworld.swarm.Swarm" title="underworld.swarm.Swarm"><code class="xref py py-obj docutils literal"><span class="pre">underworld.swarm.Swarm</span></code></a></td>
<td>The Swarm class supports particle like data structures.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#underworld.swarm.IntegrationSwarm" title="underworld.swarm.IntegrationSwarm"><code class="xref py py-obj docutils literal"><span class="pre">underworld.swarm.IntegrationSwarm</span></code></a></td>
<td>Abstract class definition for IntegrationSwarms.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#underworld.swarm.GaussBorderIntegrationSwarm" title="underworld.swarm.GaussBorderIntegrationSwarm"><code class="xref py py-obj docutils literal"><span class="pre">underworld.swarm.GaussBorderIntegrationSwarm</span></code></a></td>
<td>Integration swarm which creates particles within the boundary faces of an element, at the Gauss points.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#underworld.swarm.SwarmAbstract" title="underworld.swarm.SwarmAbstract"><code class="xref py py-obj docutils literal"><span class="pre">underworld.swarm.SwarmAbstract</span></code></a></td>
<td>The SwarmAbstract class supports particle like data structures.</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="module-details">
<h2>Module Details<a class="headerlink" href="#module-details" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id1">
<h3>classes:<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="underworld.swarm.PopulationControl">
<em class="property">class </em><code class="descclassname">underworld.swarm.</code><code class="descname">PopulationControl</code><span class="sig-paren">(</span><em>swarm</em>, <em>deleteThreshold=0.006</em>, <em>splitThreshold=0.25</em>, <em>maxDeletions=0</em>, <em>maxSplits=3</em>, <em>aggressive=False</em>, <em>aggressiveThreshold=0.8</em>, <em>particlesPerCell=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/underworld/swarm/_population_control.html#PopulationControl"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#underworld.swarm.PopulationControl" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">underworld._stgermain.LeftOverParamsChecker</span></code></p>
<p>This class implements swarm population control mechanism. Population control
acts on a per element basic, with a discrete voronoi algorithm is used to
determine where particles should be added or removed.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>swarm</strong> (<a class="reference internal" href="#underworld.swarm.Swarm" title="underworld.swarm.Swarm"><em>underworld.swarm.Swarm</em></a>) &#8211; The swarm for which population control should occur.</li>
<li><strong>deleteThreshold</strong> (<em>float</em>) &#8211; Particle volume fraction threshold below which particle is deleted.
i.e if (particleVolume/elementVolume)&lt;deleteThreshold, then the
particle is deleted.</li>
<li><strong>splitThreshold</strong> (<em>float</em>) &#8211; Particle volume fraction threshold above which particle is split.
i.e if (particleVolume/elementVolume)&gt;splitThreshold, then the
particle is split.</li>
<li><strong>maxDeletions</strong> (<em>int</em>) &#8211; maximum number of particle deletions per cell</li>
<li><strong>maxSplits</strong> (<em>int</em>) &#8211; maximum number of particles splits per cell</li>
<li><strong>aggressive</strong> (<em>bool</em>) &#8211; When enabled, this option will invoke aggressive population control
in elements where particle counts drop below some threshold.</li>
<li><strong>aggressiveThreshold</strong> (<em>float</em>) &#8211; lower cell particle population threshold beyond which aggressive
population control occurs.
i.e if (cellParticleCount/particlesPerCell)&lt;aggressiveThreshold, then
aggressive pop control will occur.
Note that this option is only valid if &#8216;aggressive&#8217; is enabled.</li>
<li><strong>particlesPerCell</strong> (<em>int</em>) &#8211; This is the desired number of particles each element should contain.
Note that this option is only valid if &#8216;aggressive&#8217; is enabled.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<p>This simple example generates a swarm, then applies population control
to split particles.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">underworld</span> <span class="k">as</span> <span class="nn">uw</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mesh</span> <span class="o">=</span> <span class="n">uw</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">FeMesh_Cartesian</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">swarm</span> <span class="o">=</span> <span class="n">uw</span><span class="o">.</span><span class="n">swarm</span><span class="o">.</span><span class="n">Swarm</span><span class="p">(</span><span class="n">mesh</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">swarm</span><span class="o">.</span><span class="n">populate_using_layout</span><span class="p">(</span><span class="n">uw</span><span class="o">.</span><span class="n">swarm</span><span class="o">.</span><span class="n">layouts</span><span class="o">.</span><span class="n">PerCellGaussLayout</span><span class="p">(</span><span class="n">swarm</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">population_control</span> <span class="o">=</span> <span class="n">uw</span><span class="o">.</span><span class="n">swarm</span><span class="o">.</span><span class="n">PopulationControl</span><span class="p">(</span><span class="n">swarm</span><span class="p">,</span><span class="n">deleteThreshold</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span><span class="n">splitThreshold</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span><span class="n">maxDeletions</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">maxSplits</span><span class="o">=</span><span class="mi">9999</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">population_control</span><span class="o">.</span><span class="n">repopulate</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">swarm</span><span class="o">.</span><span class="n">particleGlobalCount</span>
<span class="go">512</span>
</pre></div>
</div>
<dl class="method">
<dt id="underworld.swarm.PopulationControl.repopulate">
<code class="descname">repopulate</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/underworld/swarm/_population_control.html#PopulationControl.repopulate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#underworld.swarm.PopulationControl.repopulate" title="Permalink to this definition">¶</a></dt>
<dd><p>This method repopulates the swarm.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="underworld.swarm.SwarmVariable">
<em class="property">class </em><code class="descclassname">underworld.swarm.</code><code class="descname">SwarmVariable</code><span class="sig-paren">(</span><em>swarm</em>, <em>dataType</em>, <em>count</em>, <em>writeable=True</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/underworld/swarm/_swarmvariable.html#SwarmVariable"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#underworld.swarm.SwarmVariable" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">underworld._stgermain.StgClass</span></code>, <code class="xref py py-class docutils literal"><span class="pre">underworld.function._function.Function</span></code></p>
<p>The SwarmVariable class allows users to add data to swarm particles.  The data
can be of type &#8220;char&#8221;, &#8220;short&#8221;, &#8220;int&#8221;, &#8220;float&#8221; or &#8220;double&#8221;.</p>
<p>Note that the swarm allocates one block of contiguous memory for all the particles.
The per particle variable datums is then interlaced across this memory block.</p>
<p>The recommended practise is to add all swarm variables before populating the swarm
to avoid costly reallocations.</p>
<p>Swarm variables should be added via the add_variable swarm method.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>swarm</strong> (<a class="reference internal" href="#underworld.swarm.Swarm" title="underworld.swarm.Swarm"><em>underworld.swarm.Swarm</em></a>) &#8211; The swarm of particles for which we wish to add the variable</li>
<li><strong>dataType</strong> (<em>str</em>) &#8211; The data type for the variable. Available types are  &#8220;char&#8221;,
&#8220;short&#8221;, &#8220;int&#8221;, &#8220;float&#8221; or &#8220;double&#8221;.</li>
<li><strong>count</strong> (<em>unsigned</em>) &#8211; The number of values to be stored for each particle.</li>
<li><strong>writeable</strong> (<em>bool</em>) &#8211; Signifies if the variable should be writeable.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="attribute">
<dt id="underworld.swarm.SwarmVariable.count">
<code class="descname">count</code><a class="headerlink" href="#underworld.swarm.SwarmVariable.count" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">Number of data items for this variable stored on each particle.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">int</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="underworld.swarm.SwarmVariable.data">
<code class="descname">data</code><a class="headerlink" href="#underworld.swarm.SwarmVariable.data" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">Numpy proxy array to underlying variable data. Note that the
returned array is a proxy for all the <em>local</em> particle data. As
numpy arrays are simply proxys to the underlying memory structures,
no data copying is required.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">numpy.ndarray</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># create mesh</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mesh</span> <span class="o">=</span> <span class="n">uw</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">FeMesh_Cartesian</span><span class="p">(</span> <span class="n">elementType</span><span class="o">=</span><span class="s1">&#39;Q1/dQ0&#39;</span><span class="p">,</span> <span class="n">elementRes</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mi">16</span><span class="p">),</span> <span class="n">minCoord</span><span class="o">=</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">),</span> <span class="n">maxCoord</span><span class="o">=</span><span class="p">(</span><span class="mf">1.</span><span class="p">,</span><span class="mf">1.</span><span class="p">)</span> <span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># create empty swarm</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">swarm</span> <span class="o">=</span> <span class="n">uw</span><span class="o">.</span><span class="n">swarm</span><span class="o">.</span><span class="n">Swarm</span><span class="p">(</span><span class="n">mesh</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># add a variable</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">svar</span> <span class="o">=</span> <span class="n">swarm</span><span class="o">.</span><span class="n">add_variable</span><span class="p">(</span><span class="s2">&quot;int&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># add particles</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">swarm</span><span class="o">.</span><span class="n">populate_using_layout</span><span class="p">(</span><span class="n">uw</span><span class="o">.</span><span class="n">swarm</span><span class="o">.</span><span class="n">layouts</span><span class="o">.</span><span class="n">PerCellGaussLayout</span><span class="p">(</span><span class="n">swarm</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">swarm</span><span class="o">.</span><span class="n">particleLocalCount</span>
<span class="go">1024</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">len</span><span class="p">(</span><span class="n">svar</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>  <span class="c1"># should be the same as particle local count</span>
<span class="go">1024</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">swarm</span><span class="o">.</span><span class="n">owningCell</span><span class="o">.</span><span class="n">data</span>  <span class="c1"># check particle owning cells/elements.</span>
<span class="go">array([[  0],</span>
<span class="go">       [  0],</span>
<span class="go">       [  0],</span>
<span class="go">       ...,</span>
<span class="go">       [255],</span>
<span class="go">       [255],</span>
<span class="go">       [255]], dtype=int32)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># particle coords</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">swarm</span><span class="o">.</span><span class="n">particleCoordinates</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">array([ 0.0132078,  0.0132078])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># move the particle</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">swarm</span><span class="o">.</span><span class="n">deform_swarm</span><span class="p">():</span>
<span class="gp">... </span>    <span class="n">swarm</span><span class="o">.</span><span class="n">particleCoordinates</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.2</span><span class="p">,</span><span class="mf">0.2</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">swarm</span><span class="o">.</span><span class="n">particleCoordinates</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">array([ 0.2,  0.2])</span>
</pre></div>
</div>
</dd></dl>

<dl class="attribute">
<dt id="underworld.swarm.SwarmVariable.dataType">
<code class="descname">dataType</code><a class="headerlink" href="#underworld.swarm.SwarmVariable.dataType" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">Data type for variable.  Supported types are &#8216;char&#8217;, &#8216;short&#8217;, &#8216;int&#8217;,
&#8216;float&#8217; and &#8216;double&#8217;.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">str</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="underworld.swarm.SwarmVariable.data_shadow">
<code class="descname">data_shadow</code><a class="headerlink" href="#underworld.swarm.SwarmVariable.data_shadow" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">Numpy proxy array to underlying variable shadow data.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">numpy.ndarray</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<p>Refer to example provided for &#8216;data&#8217; property(/method).</p>
</dd></dl>

<dl class="method">
<dt id="underworld.swarm.SwarmVariable.load">
<code class="descname">load</code><span class="sig-paren">(</span><em>filename</em>, <em>verbose=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/underworld/swarm/_swarmvariable.html#SwarmVariable.load"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#underworld.swarm.SwarmVariable.load" title="Permalink to this definition">¶</a></dt>
<dd><p>Load the swarm variable from disk. This must be called <em>after</em> the swarm.load().</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>filename</strong> (<em>str</em>) &#8211; The filename for the saved file. Relative or absolute paths may be
used, but all directories must exist.</li>
<li><strong>verbose</strong> (<em>bool</em>) &#8211; Prints a swarm variable load progress bar.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>This method must be called collectively by all processes.</p>
<p class="rubric">Example</p>
<p>Refer to example provided for &#8216;save&#8217; method.</p>
</dd></dl>

<dl class="method">
<dt id="underworld.swarm.SwarmVariable.save">
<code class="descname">save</code><span class="sig-paren">(</span><em>filename</em>, <em>swarmFilepath=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/underworld/swarm/_swarmvariable.html#SwarmVariable.save"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#underworld.swarm.SwarmVariable.save" title="Permalink to this definition">¶</a></dt>
<dd><p>Save the swarm variable to disk.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>filename</strong> (<em>str</em>) &#8211; The filename for the saved file. Relative or absolute paths may be
used, but all directories must exist.</li>
<li><strong>swarmFilepath</strong> (<em>str</em>) &#8211; Path to the save swarm file. If provided, a softlink is created within
the swarm variable file to the swarm file.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Data object relating to saved file. This only needs to be retained
if you wish to create XDMF files and can be ignored otherwise.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="underworld.utils.html#underworld.utils.SavedFileData" title="underworld.utils.SavedFileData">underworld.utils.SavedFileData</a></p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>This method must be called collectively by all processes.</p>
<p class="rubric">Example</p>
<p>First create the swarm, populate, then add a variable:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mesh</span> <span class="o">=</span> <span class="n">uw</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">FeMesh_Cartesian</span><span class="p">(</span> <span class="n">elementType</span><span class="o">=</span><span class="s1">&#39;Q1/dQ0&#39;</span><span class="p">,</span> <span class="n">elementRes</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mi">16</span><span class="p">),</span> <span class="n">minCoord</span><span class="o">=</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">),</span> <span class="n">maxCoord</span><span class="o">=</span><span class="p">(</span><span class="mf">1.</span><span class="p">,</span><span class="mf">1.</span><span class="p">)</span> <span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">swarm</span> <span class="o">=</span> <span class="n">uw</span><span class="o">.</span><span class="n">swarm</span><span class="o">.</span><span class="n">Swarm</span><span class="p">(</span><span class="n">mesh</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">swarm</span><span class="o">.</span><span class="n">populate_using_layout</span><span class="p">(</span><span class="n">uw</span><span class="o">.</span><span class="n">swarm</span><span class="o">.</span><span class="n">layouts</span><span class="o">.</span><span class="n">PerCellGaussLayout</span><span class="p">(</span><span class="n">swarm</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">svar</span> <span class="o">=</span> <span class="n">swarm</span><span class="o">.</span><span class="n">add_variable</span><span class="p">(</span><span class="s2">&quot;int&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p>Write something to variable</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">svar</span><span class="o">.</span><span class="n">data</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">swarm</span><span class="o">.</span><span class="n">particleLocalCount</span><span class="p">)</span>
</pre></div>
</div>
<p>Save to a file:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ignoreMe</span> <span class="o">=</span> <span class="n">swarm</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;saved_swarm.h5&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ignoreMe</span> <span class="o">=</span> <span class="n">svar</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;saved_swarm_variable.h5&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Now let&#8217;s try and reload. First create a new swarm and swarm variable,
and then load both:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">clone_swarm</span> <span class="o">=</span> <span class="n">uw</span><span class="o">.</span><span class="n">swarm</span><span class="o">.</span><span class="n">Swarm</span><span class="p">(</span><span class="n">mesh</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">clone_svar</span> <span class="o">=</span> <span class="n">clone_swarm</span><span class="o">.</span><span class="n">add_variable</span><span class="p">(</span><span class="s2">&quot;int&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">clone_swarm</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;saved_swarm.h5&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">clone_svar</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;saved_swarm_variable.h5&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Now check for equality:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">svar</span><span class="o">.</span><span class="n">data</span><span class="p">,</span><span class="n">clone_svar</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># clean up:</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">if</span> <span class="n">uw</span><span class="o">.</span><span class="n">rank</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<span class="gp">... </span>    <span class="kn">import</span> <span class="nn">os</span><span class="p">;</span>
<span class="gp">... </span>    <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span> <span class="s2">&quot;saved_swarm.h5&quot;</span> <span class="p">)</span>
<span class="gp">... </span>    <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span> <span class="s2">&quot;saved_swarm_variable.h5&quot;</span> <span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="attribute">
<dt id="underworld.swarm.SwarmVariable.swarm">
<code class="descname">swarm</code><a class="headerlink" href="#underworld.swarm.SwarmVariable.swarm" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">The swarm this variable belongs to.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference internal" href="#underworld.swarm.Swarm" title="underworld.swarm.Swarm">underworld.swarm.Swarm</a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="underworld.swarm.SwarmVariable.xdmf">
<code class="descname">xdmf</code><span class="sig-paren">(</span><em>filename</em>, <em>varSavedData</em>, <em>varname</em>, <em>swarmSavedData</em>, <em>swarmname</em>, <em>modeltime=0.0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/underworld/swarm/_swarmvariable.html#SwarmVariable.xdmf"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#underworld.swarm.SwarmVariable.xdmf" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates an xdmf file, filename, associating the varSavedData file on
the swarmSavedData file</p>
<p class="rubric">Notes</p>
<p>xdmf contain 2 files: an .xml and a .h5 file. See <a class="reference external" href="http://www.xdmf.org/index.php/Main_Page">http://www.xdmf.org/index.php/Main_Page</a>
This method only needs to be called by the master process, all other
processes return quietly.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>filename</strong> (<em>str</em>) &#8211; The output path to write the xdmf file. Relative or absolute paths may be
used, but all directories must exist.</li>
<li><strong>varname</strong> (<em>str</em>) &#8211; The xdmf name to give the swarmVariable</li>
<li><strong>swarmname</strong> (<em>str</em>) &#8211; The xdmf name to give the swarm</li>
<li><strong>swarmSavedData</strong> (<em>underworld.utils.SaveFileData</em>) &#8211; Handler returned for saving a swarm. underworld.swarm.Swarm.save(xxx)</li>
<li><strong>varSavedData</strong> (<a class="reference internal" href="underworld.utils.html#underworld.utils.SavedFileData" title="underworld.utils.SavedFileData"><em>underworld.utils.SavedFileData</em></a>) &#8211; Handler returned from saving a SwarmVariable. underworld.swarm.SwarmVariable.save(xxx)</li>
<li><strong>modeltime</strong> (<em>float</em><em> (</em><em>default 0.0</em><em>)</em><em></em>) &#8211; The time recorded in the xdmf output file</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<p>First create the swarm and add a variable:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mesh</span> <span class="o">=</span> <span class="n">uw</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">FeMesh_Cartesian</span><span class="p">(</span> <span class="n">elementType</span><span class="o">=</span><span class="s1">&#39;Q1/dQ0&#39;</span><span class="p">,</span> <span class="n">elementRes</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mi">16</span><span class="p">),</span> <span class="n">minCoord</span><span class="o">=</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">),</span> <span class="n">maxCoord</span><span class="o">=</span><span class="p">(</span><span class="mf">1.</span><span class="p">,</span><span class="mf">1.</span><span class="p">)</span> <span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">swarm</span> <span class="o">=</span> <span class="n">uw</span><span class="o">.</span><span class="n">swarm</span><span class="o">.</span><span class="n">Swarm</span><span class="p">(</span> <span class="n">mesh</span><span class="o">=</span><span class="n">mesh</span> <span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">swarmLayout</span> <span class="o">=</span> <span class="n">uw</span><span class="o">.</span><span class="n">swarm</span><span class="o">.</span><span class="n">layouts</span><span class="o">.</span><span class="n">PerCellGaussLayout</span><span class="p">(</span><span class="n">swarm</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">swarm</span><span class="o">.</span><span class="n">populate_using_layout</span><span class="p">(</span> <span class="n">layout</span><span class="o">=</span><span class="n">swarmLayout</span> <span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">swarmVar</span> <span class="o">=</span> <span class="n">swarm</span><span class="o">.</span><span class="n">add_variable</span><span class="p">(</span> <span class="n">dataType</span><span class="o">=</span><span class="s2">&quot;int&quot;</span><span class="p">,</span> <span class="n">count</span><span class="o">=</span><span class="mi">1</span> <span class="p">)</span>
</pre></div>
</div>
<p>Write something to variable</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">swarmVar</span><span class="o">.</span><span class="n">data</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">swarmVar</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
<p>Save mesh and var to a file:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">swarmDat</span> <span class="o">=</span> <span class="n">swarm</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;saved_swarm.h5&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">swarmVarDat</span> <span class="o">=</span> <span class="n">swarmVar</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;saved_swarmvariable.h5&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Now let&#8217;s create the xdmf file</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">swarmVar</span><span class="o">.</span><span class="n">xdmf</span><span class="p">(</span><span class="s2">&quot;TESTxdmf&quot;</span><span class="p">,</span> <span class="n">swarmVarDat</span><span class="p">,</span> <span class="s2">&quot;var1&quot;</span><span class="p">,</span> <span class="n">swarmDat</span><span class="p">,</span> <span class="s2">&quot;MrSwarm&quot;</span> <span class="p">)</span>
</pre></div>
</div>
<p>Does file exist?</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">os</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">if</span> <span class="n">uw</span><span class="o">.</span><span class="n">rank</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="s2">&quot;TESTxdmf.xdmf&quot;</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># clean up:</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">if</span> <span class="n">uw</span><span class="o">.</span><span class="n">rank</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<span class="gp">... </span>    <span class="kn">import</span> <span class="nn">os</span><span class="p">;</span>
<span class="gp">... </span>    <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span> <span class="s2">&quot;saved_swarm.h5&quot;</span> <span class="p">)</span>
<span class="gp">... </span>    <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span> <span class="s2">&quot;saved_swarmvariable.h5&quot;</span> <span class="p">)</span>
<span class="gp">... </span>    <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span> <span class="s2">&quot;TESTxdmf.xdmf&quot;</span> <span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="underworld.swarm.GaussIntegrationSwarm">
<em class="property">class </em><code class="descclassname">underworld.swarm.</code><code class="descname">GaussIntegrationSwarm</code><span class="sig-paren">(</span><em>mesh</em>, <em>particleCount=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/underworld/swarm/_integration_swarm.html#GaussIntegrationSwarm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#underworld.swarm.GaussIntegrationSwarm" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">underworld.swarm._integration_swarm.IntegrationSwarm</span></code></p>
<p>Integration swarm which creates particles within an element at the Gauss
points.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>mesh</strong> (<a class="reference internal" href="underworld.mesh.html#underworld.mesh.FeMesh" title="underworld.mesh.FeMesh"><em>underworld.mesh.FeMesh</em></a>) &#8211; The FeMesh the swarm is supported by. See Swarm.mesh property docstring
for further information.</li>
<li><strong>particleCount</strong> (<em>unsigned. Default is 3</em><em>, </em><em>unless Q2 mesh which takes default 5.</em>) &#8211; Number of gauss particles in each direction.  Must take value in [1,5].</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="class">
<dt id="underworld.swarm.VoronoiIntegrationSwarm">
<em class="property">class </em><code class="descclassname">underworld.swarm.</code><code class="descname">VoronoiIntegrationSwarm</code><span class="sig-paren">(</span><em>swarm</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/underworld/swarm/_integration_swarm.html#VoronoiIntegrationSwarm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#underworld.swarm.VoronoiIntegrationSwarm" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">underworld.swarm._integration_swarm.IntegrationSwarm</span></code>, <code class="xref py py-class docutils literal"><span class="pre">underworld.function._function.FunctionInput</span></code></p>
<p>Class for an IntegrationSwarm that maps to another Swarm</p>
<p>Note that this swarm can act as a function input. In this capacity,
the fundamental function input type is the FEMCoordinate (ie, the particle
local coordinate, the owning mesh, and the owning element). This input
can be reduced to the global coordinate when returned within python. The
FEMCoordinate particle representation is useful when deforming a mesh, as
it is possible to deform the mesh, and then use the FEMCoordinate to reset
the particles within the moved mesh.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>swarm</strong> (<a class="reference internal" href="#underworld.swarm.Swarm" title="underworld.swarm.Swarm"><em>underworld.swarm.Swarm</em></a>) &#8211; The PIC integration swarm maps to this user provided swarm.</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<p>This simple example checks that the true global coordiante, and that
derived from the local coordinate, are close to equal. Note that the
VoronoiIntegrationSwarm uses a voronoi centroid algorithm so we do not
expect particle to exactly coincide.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">underworld</span> <span class="k">as</span> <span class="nn">uw</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mesh</span> <span class="o">=</span> <span class="n">uw</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">FeMesh_Cartesian</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">swarm</span> <span class="o">=</span> <span class="n">uw</span><span class="o">.</span><span class="n">swarm</span><span class="o">.</span><span class="n">Swarm</span><span class="p">(</span><span class="n">mesh</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">swarm</span><span class="o">.</span><span class="n">populate_using_layout</span><span class="p">(</span><span class="n">uw</span><span class="o">.</span><span class="n">swarm</span><span class="o">.</span><span class="n">layouts</span><span class="o">.</span><span class="n">PerCellGaussLayout</span><span class="p">(</span><span class="n">swarm</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vswarm</span> <span class="o">=</span> <span class="n">uw</span><span class="o">.</span><span class="n">swarm</span><span class="o">.</span><span class="n">VoronoiIntegrationSwarm</span><span class="p">(</span><span class="n">swarm</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vswarm</span><span class="o">.</span><span class="n">repopulate</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">swarm</span><span class="o">.</span><span class="n">particleCoordinates</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">uw</span><span class="o">.</span><span class="n">function</span><span class="o">.</span><span class="n">input</span><span class="p">()</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">vswarm</span><span class="p">),</span><span class="n">atol</span><span class="o">=</span><span class="mi">1</span><span class="n">e</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<dl class="method">
<dt id="underworld.swarm.VoronoiIntegrationSwarm.repopulate">
<code class="descname">repopulate</code><span class="sig-paren">(</span><em>weights_calculator=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/underworld/swarm/_integration_swarm.html#VoronoiIntegrationSwarm.repopulate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#underworld.swarm.VoronoiIntegrationSwarm.repopulate" title="Permalink to this definition">¶</a></dt>
<dd><p>This method repopulates the voronoi swarm using the provided
global swarm. The weights are also recalculated.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>weights_calculator</strong> (<em>underworld.swarm.Weights</em>) &#8211; The weights calculator for the Voronoi swarm. If none is provided,
a default DVCWeights calculator is used.</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="underworld.swarm.Swarm">
<em class="property">class </em><code class="descclassname">underworld.swarm.</code><code class="descname">Swarm</code><span class="sig-paren">(</span><em>mesh</em>, <em>particleEscape=False</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/underworld/swarm/_swarm.html#Swarm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#underworld.swarm.Swarm" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">underworld.swarm._swarmabstract.SwarmAbstract</span></code>, <code class="xref py py-class docutils literal"><span class="pre">underworld.function._function.FunctionInput</span></code>, <code class="xref py py-class docutils literal"><span class="pre">underworld._stgermain.Save</span></code></p>
<p>The Swarm class supports particle like data structures. Each instance of
this class will store a set of unique particles. In this context, particles
are data structures which store a location variable, along with any other
variables the user requests.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>mesh</strong> (<a class="reference internal" href="underworld.mesh.html#underworld.mesh.FeMesh" title="underworld.mesh.FeMesh"><em>underworld.mesh.FeMesh</em></a>) &#8211; The FeMesh the swarm is supported by. See Swarm.mesh property docstring
for further information.</li>
<li><strong>particleEscape</strong> (<em>bool</em>) &#8211; If set to true, particles are deleted when they leave the domain. This
may occur during particle advection, or when the mesh is deformed.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<p>Create a swarm with some variables:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># First we need a mesh:</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mesh</span> <span class="o">=</span> <span class="n">uw</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">FeMesh_Cartesian</span><span class="p">(</span> <span class="n">elementType</span><span class="o">=</span><span class="s1">&#39;Q1/dQ0&#39;</span><span class="p">,</span> <span class="n">elementRes</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mi">16</span><span class="p">),</span> <span class="n">minCoord</span><span class="o">=</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">),</span> <span class="n">maxCoord</span><span class="o">=</span><span class="p">(</span><span class="mf">1.</span><span class="p">,</span><span class="mf">1.</span><span class="p">)</span> <span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create empty swarm:</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">swarm</span> <span class="o">=</span> <span class="n">uw</span><span class="o">.</span><span class="n">swarm</span><span class="o">.</span><span class="n">Swarm</span><span class="p">(</span><span class="n">mesh</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Add a variable:</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">svar</span> <span class="o">=</span> <span class="n">swarm</span><span class="o">.</span><span class="n">add_variable</span><span class="p">(</span><span class="s2">&quot;char&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Add another:</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">svar</span> <span class="o">=</span> <span class="n">swarm</span><span class="o">.</span><span class="n">add_variable</span><span class="p">(</span><span class="s2">&quot;double&quot;</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Now use a layout to fill with particles</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">swarm</span><span class="o">.</span><span class="n">particleLocalCount</span>
<span class="go">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">layout</span> <span class="o">=</span> <span class="n">uw</span><span class="o">.</span><span class="n">swarm</span><span class="o">.</span><span class="n">layouts</span><span class="o">.</span><span class="n">PerCellGaussLayout</span><span class="p">(</span><span class="n">swarm</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">swarm</span><span class="o">.</span><span class="n">populate_using_layout</span><span class="p">(</span><span class="n">layout</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">swarm</span><span class="o">.</span><span class="n">particleLocalCount</span>
<span class="go">1024</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">swarm</span><span class="o">.</span><span class="n">particleCoordinates</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">array([ 0.0132078,  0.0132078])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">swarm</span><span class="o">.</span><span class="n">owningCell</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">array([0], dtype=int32)</span>
</pre></div>
</div>
<p>With particleEscape enabled, particles which are no longer within the mesh
domain are deleted.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mesh</span> <span class="o">=</span> <span class="n">uw</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">FeMesh_Cartesian</span><span class="p">(</span> <span class="n">elementType</span><span class="o">=</span><span class="s1">&#39;Q1/dQ0&#39;</span><span class="p">,</span> <span class="n">elementRes</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mi">16</span><span class="p">),</span> <span class="n">minCoord</span><span class="o">=</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">),</span> <span class="n">maxCoord</span><span class="o">=</span><span class="p">(</span><span class="mf">1.</span><span class="p">,</span><span class="mf">1.</span><span class="p">)</span> <span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">swarm</span> <span class="o">=</span> <span class="n">uw</span><span class="o">.</span><span class="n">swarm</span><span class="o">.</span><span class="n">Swarm</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">particleEscape</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">swarm</span><span class="o">.</span><span class="n">particleLocalCount</span>
<span class="go">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">layout</span> <span class="o">=</span> <span class="n">uw</span><span class="o">.</span><span class="n">swarm</span><span class="o">.</span><span class="n">layouts</span><span class="o">.</span><span class="n">PerCellGaussLayout</span><span class="p">(</span><span class="n">swarm</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">swarm</span><span class="o">.</span><span class="n">populate_using_layout</span><span class="p">(</span><span class="n">layout</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">swarm</span><span class="o">.</span><span class="n">particleGlobalCount</span>
<span class="go">1024</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">mesh</span><span class="o">.</span><span class="n">deform_mesh</span><span class="p">():</span>
<span class="gp">... </span>    <span class="n">mesh</span><span class="o">.</span><span class="n">data</span><span class="p">[:]</span> <span class="o">+=</span> <span class="p">(</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">swarm</span><span class="o">.</span><span class="n">particleGlobalCount</span>
<span class="go">512</span>
</pre></div>
</div>
<p>Alternatively, moving the particles:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mesh</span> <span class="o">=</span> <span class="n">uw</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">FeMesh_Cartesian</span><span class="p">(</span> <span class="n">elementType</span><span class="o">=</span><span class="s1">&#39;Q1/dQ0&#39;</span><span class="p">,</span> <span class="n">elementRes</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mi">16</span><span class="p">),</span> <span class="n">minCoord</span><span class="o">=</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">),</span> <span class="n">maxCoord</span><span class="o">=</span><span class="p">(</span><span class="mf">1.</span><span class="p">,</span><span class="mf">1.</span><span class="p">)</span> <span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">swarm</span> <span class="o">=</span> <span class="n">uw</span><span class="o">.</span><span class="n">swarm</span><span class="o">.</span><span class="n">Swarm</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">particleEscape</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">swarm</span><span class="o">.</span><span class="n">particleLocalCount</span>
<span class="go">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">layout</span> <span class="o">=</span> <span class="n">uw</span><span class="o">.</span><span class="n">swarm</span><span class="o">.</span><span class="n">layouts</span><span class="o">.</span><span class="n">PerCellGaussLayout</span><span class="p">(</span><span class="n">swarm</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">swarm</span><span class="o">.</span><span class="n">populate_using_layout</span><span class="p">(</span><span class="n">layout</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">swarm</span><span class="o">.</span><span class="n">particleGlobalCount</span>
<span class="go">1024</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">swarm</span><span class="o">.</span><span class="n">deform_swarm</span><span class="p">():</span>
<span class="gp">... </span>    <span class="n">swarm</span><span class="o">.</span><span class="n">particleCoordinates</span><span class="o">.</span><span class="n">data</span><span class="p">[:]</span> <span class="o">-=</span> <span class="p">(</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">swarm</span><span class="o">.</span><span class="n">particleGlobalCount</span>
<span class="go">512</span>
</pre></div>
</div>
<dl class="method">
<dt id="underworld.swarm.Swarm.add_particles_with_coordinates">
<code class="descname">add_particles_with_coordinates</code><span class="sig-paren">(</span><em>coordinatesArray</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/underworld/swarm/_swarm.html#Swarm.add_particles_with_coordinates"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#underworld.swarm.Swarm.add_particles_with_coordinates" title="Permalink to this definition">¶</a></dt>
<dd><p>This method adds particles to the swarm using particle coordinates provided
using a numpy array.</p>
<p>Note that particles with coordinates NOT local to the current processor will
be reject/ignored.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>coordinatesArray</strong> (<em>numpy.ndarray</em>) &#8211; The numpy array containing the coordinate of the new particles. Array is
expected to take shape n*dim, where n is the number of new particles, and
dim is the dimensionality of the swarm&#8217;s supporting mesh.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Array containing the local index of the added particles. Rejected particles
are denoted with an index of -1.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">numpy.ndarray</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mesh</span> <span class="o">=</span> <span class="n">uw</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">FeMesh_Cartesian</span><span class="p">(</span> <span class="n">elementType</span><span class="o">=</span><span class="s1">&#39;Q1/dQ0&#39;</span><span class="p">,</span> <span class="n">elementRes</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span> <span class="n">minCoord</span><span class="o">=</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">),</span> <span class="n">maxCoord</span><span class="o">=</span><span class="p">(</span><span class="mf">1.</span><span class="p">,</span><span class="mf">1.</span><span class="p">)</span> <span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">swarm</span> <span class="o">=</span> <span class="n">uw</span><span class="o">.</span><span class="n">swarm</span><span class="o">.</span><span class="n">Swarm</span><span class="p">(</span><span class="n">mesh</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">5</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span><span class="mf">0.1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.2</span><span class="p">,</span><span class="mf">0.1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span><span class="mf">0.2</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span><span class="o">-</span><span class="mf">0.1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.8</span><span class="p">,</span><span class="mf">0.8</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">swarm</span><span class="o">.</span><span class="n">add_particles_with_coordinates</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>
<span class="go">array([ 0,  1,  2, -1,  3], dtype=int32)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">swarm</span><span class="o">.</span><span class="n">particleLocalCount</span>
<span class="go">4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">swarm</span><span class="o">.</span><span class="n">particleCoordinates</span><span class="o">.</span><span class="n">data</span>
<span class="go">array([[ 0.1,  0.1],</span>
<span class="go">       [ 0.2,  0.1],</span>
<span class="go">       [ 0.1,  0.2],</span>
<span class="go">       [ 0.8,  0.8]])</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="underworld.swarm.Swarm.deform_swarm">
<code class="descname">deform_swarm</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwds</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/underworld/swarm/_swarm.html#Swarm.deform_swarm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#underworld.swarm.Swarm.deform_swarm" title="Permalink to this definition">¶</a></dt>
<dd><p>Any particle location modifications must occur within this python
context manager. This is necessary as it is critical that certain
internal objects are updated when particle locations are modified.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>update_owners</strong> (<em>bool</em><em>, </em><em>default=True</em>) &#8211; If this is set to False, particle ownership (which element owns a
particular particle) is not updated at the conclusion of the context
manager. This is often necessary when both the mesh and particles
are advecting simutaneously.</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mesh</span> <span class="o">=</span> <span class="n">uw</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">FeMesh_Cartesian</span><span class="p">(</span> <span class="n">elementType</span><span class="o">=</span><span class="s1">&#39;Q1/dQ0&#39;</span><span class="p">,</span> <span class="n">elementRes</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mi">16</span><span class="p">),</span> <span class="n">minCoord</span><span class="o">=</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">),</span> <span class="n">maxCoord</span><span class="o">=</span><span class="p">(</span><span class="mf">1.</span><span class="p">,</span><span class="mf">1.</span><span class="p">)</span> <span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">swarm</span> <span class="o">=</span> <span class="n">uw</span><span class="o">.</span><span class="n">swarm</span><span class="o">.</span><span class="n">Swarm</span><span class="p">(</span><span class="n">mesh</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">layout</span> <span class="o">=</span> <span class="n">uw</span><span class="o">.</span><span class="n">swarm</span><span class="o">.</span><span class="n">layouts</span><span class="o">.</span><span class="n">PerCellGaussLayout</span><span class="p">(</span><span class="n">swarm</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">swarm</span><span class="o">.</span><span class="n">populate_using_layout</span><span class="p">(</span><span class="n">layout</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">swarm</span><span class="o">.</span><span class="n">particleCoordinates</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">array([ 0.0132078,  0.0132078])</span>
</pre></div>
</div>
<p>Attempted modification without using deform_swarm() should fail:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">swarm</span><span class="o">.</span><span class="n">particleCoordinates</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.2</span><span class="p">,</span><span class="mf">0.2</span><span class="p">]</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">assignment destination is read-only</span>
</pre></div>
</div>
<p>Within the deform_swarm() context manager, modification is allowed:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">swarm</span><span class="o">.</span><span class="n">deform_swarm</span><span class="p">():</span>
<span class="gp">... </span>    <span class="n">swarm</span><span class="o">.</span><span class="n">particleCoordinates</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.2</span><span class="p">,</span><span class="mf">0.2</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">swarm</span><span class="o">.</span><span class="n">particleCoordinates</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">array([ 0.2,  0.2])</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="underworld.swarm.Swarm.fn_particle_found">
<code class="descname">fn_particle_found</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/underworld/swarm/_swarm.html#Swarm.fn_particle_found"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#underworld.swarm.Swarm.fn_particle_found" title="Permalink to this definition">¶</a></dt>
<dd><p>This function returns True where a particle is able to be found using
the provided input to function evaluation.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">The function object.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference internal" href="underworld.function.html#underworld.function.Function" title="underworld.function.Function">underworld.function.Function</a></td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<p>Setup some things:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mesh</span> <span class="o">=</span> <span class="n">uw</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">FeMesh_Cartesian</span><span class="p">(</span><span class="n">elementRes</span><span class="o">=</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span><span class="mi">32</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">swarm</span> <span class="o">=</span> <span class="n">uw</span><span class="o">.</span><span class="n">swarm</span><span class="o">.</span><span class="n">Swarm</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">particleEscape</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">layout</span> <span class="o">=</span> <span class="n">uw</span><span class="o">.</span><span class="n">swarm</span><span class="o">.</span><span class="n">layouts</span><span class="o">.</span><span class="n">PerCellGaussLayout</span><span class="p">(</span><span class="n">swarm</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">swarm</span><span class="o">.</span><span class="n">populate_using_layout</span><span class="p">(</span><span class="n">layout</span><span class="p">)</span>
</pre></div>
</div>
<p>Now, evaluate the fn_particle_found function on the swarm.. all
should be true</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fn_pf</span> <span class="o">=</span> <span class="n">swarm</span><span class="o">.</span><span class="n">fn_particle_found</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fn_pf</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">swarm</span><span class="p">)</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Evalute at arbitrary coord... should return False</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fn_pf</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span> <span class="p">(</span><span class="mf">0.3</span><span class="p">,</span><span class="mf">0.9</span><span class="p">)</span> <span class="p">)</span>
<span class="go">array([[False]], dtype=bool)</span>
</pre></div>
</div>
<p>Now, lets get rid of all particles outside of a circle, and look
to obtain pi/4.  First eject particles:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">swarm</span><span class="o">.</span><span class="n">deform_swarm</span><span class="p">():</span>
<span class="gp">... </span>   <span class="k">for</span> <span class="n">ind</span><span class="p">,</span><span class="n">coord</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">swarm</span><span class="o">.</span><span class="n">particleCoordinates</span><span class="o">.</span><span class="n">data</span><span class="p">):</span>
<span class="gp">... </span>       <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">coord</span><span class="p">,</span><span class="n">coord</span><span class="p">)</span><span class="o">&gt;</span><span class="mf">1.</span><span class="p">:</span>
<span class="gp">... </span>           <span class="n">swarm</span><span class="o">.</span><span class="n">particleCoordinates</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mf">99999.</span><span class="p">,</span><span class="mf">99999.</span><span class="p">)</span>
</pre></div>
</div>
<p>Now integrate and test</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">incirc</span> <span class="o">=</span> <span class="n">uw</span><span class="o">.</span><span class="n">function</span><span class="o">.</span><span class="n">branching</span><span class="o">.</span><span class="n">conditional</span><span class="p">(</span> <span class="p">(</span> <span class="p">(</span><span class="n">fn_pf</span><span class="p">,</span><span class="mf">1.</span><span class="p">),(</span><span class="kc">True</span><span class="p">,</span><span class="mf">0.</span><span class="p">)</span>  <span class="p">)</span> <span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">uw</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">Integral</span><span class="p">(</span><span class="n">incirc</span><span class="p">,</span> <span class="n">mesh</span><span class="p">)</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(),</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mf">4.</span><span class="p">,</span><span class="n">rtol</span><span class="o">=</span><span class="mi">2</span><span class="n">e</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>
<span class="go">array([ True], dtype=bool)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="underworld.swarm.Swarm.load">
<code class="descname">load</code><span class="sig-paren">(</span><em>filename</em>, <em>verbose=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/underworld/swarm/_swarm.html#Swarm.load"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#underworld.swarm.Swarm.load" title="Permalink to this definition">¶</a></dt>
<dd><p>Load a swarm from disk. Note that this must be called before any SwarmVariable
members are loaded.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>filename</strong> (<em>str</em>) &#8211; The filename for the saved file. Relative or absolute paths may be
used.</li>
<li><strong>verbose</strong> (<em>bool</em>) &#8211; Prints a swarm load progress bar.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>This method must be called collectively by all processes.</p>
<p class="rubric">Example</p>
<p>Refer to example provided for &#8216;save&#8217; method.</p>
</dd></dl>

<dl class="attribute">
<dt id="underworld.swarm.Swarm.particleGlobalCount">
<code class="descname">particleGlobalCount</code><a class="headerlink" href="#underworld.swarm.Swarm.particleGlobalCount" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">The global number (across all processes) of particles in the swarm.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">int</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="underworld.swarm.Swarm.save">
<code class="descname">save</code><span class="sig-paren">(</span><em>filename</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/underworld/swarm/_swarm.html#Swarm.save"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#underworld.swarm.Swarm.save" title="Permalink to this definition">¶</a></dt>
<dd><p>Save the swarm to disk.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>filename</strong> (<em>str</em>) &#8211; The filename for the saved file. Relative or absolute paths may be
used, but all directories must exist.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Data object relating to saved file. This only needs to be retained
if you wish to create XDMF files and can be ignored otherwise.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference internal" href="underworld.utils.html#underworld.utils.SavedFileData" title="underworld.utils.SavedFileData">underworld.utils.SavedFileData</a></td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>This method must be called collectively by all processes.</p>
<p class="rubric">Example</p>
<p>First create the swarm, and populate with layout:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mesh</span> <span class="o">=</span> <span class="n">uw</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">FeMesh_Cartesian</span><span class="p">(</span> <span class="n">elementType</span><span class="o">=</span><span class="s1">&#39;Q1/dQ0&#39;</span><span class="p">,</span> <span class="n">elementRes</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mi">16</span><span class="p">),</span> <span class="n">minCoord</span><span class="o">=</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">),</span> <span class="n">maxCoord</span><span class="o">=</span><span class="p">(</span><span class="mf">1.</span><span class="p">,</span><span class="mf">1.</span><span class="p">)</span> <span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">swarm</span> <span class="o">=</span> <span class="n">uw</span><span class="o">.</span><span class="n">swarm</span><span class="o">.</span><span class="n">Swarm</span><span class="p">(</span><span class="n">mesh</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">swarm</span><span class="o">.</span><span class="n">populate_using_layout</span><span class="p">(</span><span class="n">uw</span><span class="o">.</span><span class="n">swarm</span><span class="o">.</span><span class="n">layouts</span><span class="o">.</span><span class="n">PerCellGaussLayout</span><span class="p">(</span><span class="n">swarm</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
</pre></div>
</div>
<p>Save to a file:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ignoreMe</span> <span class="o">=</span> <span class="n">swarm</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;saved_swarm.h5&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Now let&#8217;s try and reload. First create an empty swarm, and then load:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">clone_swarm</span> <span class="o">=</span> <span class="n">uw</span><span class="o">.</span><span class="n">swarm</span><span class="o">.</span><span class="n">Swarm</span><span class="p">(</span><span class="n">mesh</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">clone_swarm</span><span class="o">.</span><span class="n">load</span><span class="p">(</span> <span class="s2">&quot;saved_swarm.h5&quot;</span> <span class="p">)</span>
</pre></div>
</div>
<p>Now check for equality:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">swarm</span><span class="o">.</span><span class="n">particleCoordinates</span><span class="o">.</span><span class="n">data</span><span class="p">,</span><span class="n">clone_swarm</span><span class="o">.</span><span class="n">particleCoordinates</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># clean up:</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">if</span> <span class="n">uw</span><span class="o">.</span><span class="n">rank</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<span class="gp">... </span>    <span class="kn">import</span> <span class="nn">os</span><span class="p">;</span>
<span class="gp">... </span>    <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span> <span class="s2">&quot;saved_swarm.h5&quot;</span> <span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="underworld.swarm.Swarm.shadow_particles_fetch">
<code class="descname">shadow_particles_fetch</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/underworld/swarm/_swarm.html#Swarm.shadow_particles_fetch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#underworld.swarm.Swarm.shadow_particles_fetch" title="Permalink to this definition">¶</a></dt>
<dd><p>When called, neighbouring processor particles which have coordinates
within the current processor&#8217;s shadow zone will be communicated to the
current processor. Ie, the processor shadow zone is populated using
particles that are owned by neighbouring processors. After this
method has been called, particle shadow data is available via the
<cite>data_shadow</cite> handles of SwarmVariable objects. This data is read only.</p>
<p>Note that you will need to call this whenever neighbouring information
has potentially changed, for example after swarm advection, or after
you have modified a SwarmVariable object.</p>
<p>Any existing shadow information will be discarded when this is called.</p>
<p class="rubric">Notes</p>
<p>This method must be called collectively by all processes.</p>
</dd></dl>

<dl class="method">
<dt id="underworld.swarm.Swarm.update_particle_owners">
<code class="descname">update_particle_owners</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/underworld/swarm/_swarm.html#Swarm.update_particle_owners"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#underworld.swarm.Swarm.update_particle_owners" title="Permalink to this definition">¶</a></dt>
<dd><p>This routine will update particles owners after particles have been
moved. This is both in terms of the cell/element the the
particle resides within, and also in terms of the parallel processor
decomposition (particles belonging on other processors will be sent across).</p>
<p>Users should not generally need to call this as it will be called automatically at the
conclusion of a deform_swarm() block.</p>
<p class="rubric">Notes</p>
<p>This method must be called collectively by all processes.</p>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mesh</span> <span class="o">=</span> <span class="n">uw</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">FeMesh_Cartesian</span><span class="p">(</span> <span class="n">elementType</span><span class="o">=</span><span class="s1">&#39;Q1/dQ0&#39;</span><span class="p">,</span> <span class="n">elementRes</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mi">16</span><span class="p">),</span> <span class="n">minCoord</span><span class="o">=</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">),</span> <span class="n">maxCoord</span><span class="o">=</span><span class="p">(</span><span class="mf">1.</span><span class="p">,</span><span class="mf">1.</span><span class="p">)</span> <span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">swarm</span> <span class="o">=</span> <span class="n">uw</span><span class="o">.</span><span class="n">swarm</span><span class="o">.</span><span class="n">Swarm</span><span class="p">(</span><span class="n">mesh</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">swarm</span><span class="o">.</span><span class="n">populate_using_layout</span><span class="p">(</span><span class="n">uw</span><span class="o">.</span><span class="n">swarm</span><span class="o">.</span><span class="n">layouts</span><span class="o">.</span><span class="n">PerCellGaussLayout</span><span class="p">(</span><span class="n">swarm</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">swarm</span><span class="o">.</span><span class="n">particleCoordinates</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">array([ 0.0132078,  0.0132078])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">swarm</span><span class="o">.</span><span class="n">owningCell</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">array([0], dtype=int32)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">swarm</span><span class="o">.</span><span class="n">deform_swarm</span><span class="p">():</span>
<span class="gp">... </span>    <span class="n">swarm</span><span class="o">.</span><span class="n">particleCoordinates</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span><span class="mf">0.1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">swarm</span><span class="o">.</span><span class="n">owningCell</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">array([17], dtype=int32)</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="underworld.swarm.IntegrationSwarm">
<em class="property">class </em><code class="descclassname">underworld.swarm.</code><code class="descname">IntegrationSwarm</code><span class="sig-paren">(</span><em>mesh</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/underworld/swarm/_integration_swarm.html#IntegrationSwarm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#underworld.swarm.IntegrationSwarm" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">underworld.swarm._swarmabstract.SwarmAbstract</span></code></p>
<p>Abstract class definition for IntegrationSwarms.</p>
<p>All IntegrationSwarms have the following SwarmVariables from this class:</p>
<ol class="arabic simple">
<li><dl class="first docutils">
<dt>localCoordVariable <span class="classifier-delimiter">:</span> <span class="classifier">double (number of particle, dimensions)</span></dt>
<dd>For local element coordinates of the particle</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>weightVariable <span class="classifier-delimiter">:</span> <span class="classifier">double (number of particles)</span></dt>
<dd>For the integration weight of each particle</dd>
</dl>
</li>
</ol>
<dl class="attribute">
<dt id="underworld.swarm.IntegrationSwarm.particleWeights">
<code class="descname">particleWeights</code><a class="headerlink" href="#underworld.swarm.IntegrationSwarm.particleWeights" title="Permalink to this definition">¶</a></dt>
<dd><p><em>particleWeights (SwarmVariable)</em> &#8211; Swarm variable recording the weight of the
swarm particles.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="underworld.swarm.GaussBorderIntegrationSwarm">
<em class="property">class </em><code class="descclassname">underworld.swarm.</code><code class="descname">GaussBorderIntegrationSwarm</code><span class="sig-paren">(</span><em>mesh</em>, <em>particleCount=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/underworld/swarm/_integration_swarm.html#GaussBorderIntegrationSwarm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#underworld.swarm.GaussBorderIntegrationSwarm" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">underworld.swarm._integration_swarm.GaussIntegrationSwarm</span></code></p>
<p>Integration swarm which creates particles within the boundary faces of an
element, at the Gauss points.</p>
<p>See parent class for parameters.</p>
</dd></dl>

<dl class="class">
<dt id="underworld.swarm.SwarmAbstract">
<em class="property">class </em><code class="descclassname">underworld.swarm.</code><code class="descname">SwarmAbstract</code><span class="sig-paren">(</span><em>mesh</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/underworld/swarm/_swarmabstract.html#SwarmAbstract"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#underworld.swarm.SwarmAbstract" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">underworld._stgermain.StgCompoundComponent</span></code></p>
<p>The SwarmAbstract class supports particle like data structures. Each instance of
this class will store a set of unique particles. In this context, particles
are data structures which store a location variable, along with any other
variables the user requests.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>mesh</strong> (<a class="reference internal" href="underworld.mesh.html#underworld.mesh.FeMesh" title="underworld.mesh.FeMesh"><em>underworld.mesh.FeMesh</em></a>) &#8211; The FeMesh the swarm is supported by. See Swarm.mesh property docstring
for further information.</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="underworld.swarm.SwarmAbstract.add_variable">
<code class="descname">add_variable</code><span class="sig-paren">(</span><em>dataType</em>, <em>count</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/underworld/swarm/_swarmabstract.html#SwarmAbstract.add_variable"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#underworld.swarm.SwarmAbstract.add_variable" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a variable to each particle in this swarm. Variables can be added
at any point. Removal of variables is however not currently supported.
See help(SwarmVariable) for further information.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>dataType</strong> (<em>str</em>) &#8211; The data type for the variable. Available types are  &#8220;char&#8221;,
&#8220;short&#8221;, &#8220;int&#8221;, &#8220;float&#8221; or &#8220;double&#8221;.</li>
<li><strong>count</strong> (<em>unsigned</em>) &#8211; The number of values to be stored for each particle.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">The newly created swarm variable.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="#underworld.swarm.SwarmVariable" title="underworld.swarm.SwarmVariable">underworld.swarm.SwarmVariable</a></p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># first we need a mesh</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mesh</span> <span class="o">=</span> <span class="n">uw</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">FeMesh_Cartesian</span><span class="p">(</span> <span class="n">elementType</span><span class="o">=</span><span class="s1">&#39;Q1/dQ0&#39;</span><span class="p">,</span> <span class="n">elementRes</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mi">16</span><span class="p">),</span> <span class="n">minCoord</span><span class="o">=</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">),</span> <span class="n">maxCoord</span><span class="o">=</span><span class="p">(</span><span class="mf">1.</span><span class="p">,</span><span class="mf">1.</span><span class="p">)</span> <span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># create swarm</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">swarm</span> <span class="o">=</span> <span class="n">uw</span><span class="o">.</span><span class="n">swarm</span><span class="o">.</span><span class="n">Swarm</span><span class="p">(</span><span class="n">mesh</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># add a variable</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">svar</span> <span class="o">=</span> <span class="n">swarm</span><span class="o">.</span><span class="n">add_variable</span><span class="p">(</span><span class="s2">&quot;char&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># add another</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">svar</span> <span class="o">=</span> <span class="n">swarm</span><span class="o">.</span><span class="n">add_variable</span><span class="p">(</span><span class="s2">&quot;double&quot;</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># add some particles</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">swarm</span><span class="o">.</span><span class="n">populate_using_layout</span><span class="p">(</span><span class="n">uw</span><span class="o">.</span><span class="n">swarm</span><span class="o">.</span><span class="n">layouts</span><span class="o">.</span><span class="n">PerCellGaussLayout</span><span class="p">(</span><span class="n">swarm</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># add another variable</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">svar</span> <span class="o">=</span> <span class="n">swarm</span><span class="o">.</span><span class="n">add_variable</span><span class="p">(</span><span class="s2">&quot;double&quot;</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="attribute">
<dt id="underworld.swarm.SwarmAbstract.globalId">
<code class="descname">globalId</code><a class="headerlink" href="#underworld.swarm.SwarmAbstract.globalId" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">Swarm variable recording a particle global identifier. Not yet
implemented.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference internal" href="#underworld.swarm.SwarmVariable" title="underworld.swarm.SwarmVariable">underworld.swarm.SwarmVariable</a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="underworld.swarm.SwarmAbstract.mesh">
<code class="descname">mesh</code><a class="headerlink" href="#underworld.swarm.SwarmAbstract.mesh" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">Supporting FeMesh for this Swarm. All swarms are required to be
supported by mesh (or similar) objects, which provide the data structures
necessary for efficient particle locating/tracking, as well as the necessary
mechanism for the swarm parallel decomposition.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference internal" href="underworld.mesh.html#underworld.mesh.FeMesh" title="underworld.mesh.FeMesh">underworld.mesh.FeMesh</a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="underworld.swarm.SwarmAbstract.owningCell">
<code class="descname">owningCell</code><a class="headerlink" href="#underworld.swarm.SwarmAbstract.owningCell" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">Swarm variable recording the owning cell of the swarm particles.
This will usually correspond to the owning element local id.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference internal" href="#underworld.swarm.SwarmVariable" title="underworld.swarm.SwarmVariable">underworld.swarm.SwarmVariable</a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="underworld.swarm.SwarmAbstract.particleCoordinates">
<code class="descname">particleCoordinates</code><a class="headerlink" href="#underworld.swarm.SwarmAbstract.particleCoordinates" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">Swarm variable recording the coordinates of the swarm particles.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference internal" href="#underworld.swarm.SwarmVariable" title="underworld.swarm.SwarmVariable">underworld.swarm.SwarmVariable</a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="underworld.swarm.SwarmAbstract.particleLocalCount">
<code class="descname">particleLocalCount</code><a class="headerlink" href="#underworld.swarm.SwarmAbstract.particleLocalCount" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">Number of swarm particles within the current processes local space.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">int</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="underworld.swarm.SwarmAbstract.populate_using_layout">
<code class="descname">populate_using_layout</code><span class="sig-paren">(</span><em>layout</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/underworld/swarm/_swarmabstract.html#SwarmAbstract.populate_using_layout"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#underworld.swarm.SwarmAbstract.populate_using_layout" title="Permalink to this definition">¶</a></dt>
<dd><p>This method uses the provided layout to populate the swarm with particles.
Usually layouts add particles across the entire domain. Available
layouts may be found in the swarm.layouts module.
Note that Layouts can only currently be used on empty swarms.
Also note that all numpy arrays associated with swarm variables must
be deleted before a layout can be applied.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>layout</strong> (<a class="reference internal" href="underworld.swarm.layouts.html#underworld.swarm.layouts.ParticleLayoutAbstract" title="underworld.swarm.layouts.ParticleLayoutAbstract"><em>underworld.swarm.layouts.ParticleLayoutAbstract</em></a>) &#8211; The layout which determines where particles are created and added.</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># first we need a mesh</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mesh</span> <span class="o">=</span> <span class="n">uw</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">FeMesh_Cartesian</span><span class="p">(</span> <span class="n">elementType</span><span class="o">=</span><span class="s1">&#39;Q1/dQ0&#39;</span><span class="p">,</span> <span class="n">elementRes</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mi">16</span><span class="p">),</span> <span class="n">minCoord</span><span class="o">=</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">),</span> <span class="n">maxCoord</span><span class="o">=</span><span class="p">(</span><span class="mf">1.</span><span class="p">,</span><span class="mf">1.</span><span class="p">)</span> <span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># create swarm</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">swarm</span> <span class="o">=</span> <span class="n">uw</span><span class="o">.</span><span class="n">swarm</span><span class="o">.</span><span class="n">Swarm</span><span class="p">(</span><span class="n">mesh</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># add populate</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">swarm</span><span class="o">.</span><span class="n">populate_using_layout</span><span class="p">(</span><span class="n">uw</span><span class="o">.</span><span class="n">swarm</span><span class="o">.</span><span class="n">layouts</span><span class="o">.</span><span class="n">PerCellGaussLayout</span><span class="p">(</span><span class="n">swarm</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
</pre></div>
</div>
</dd></dl>

<dl class="attribute">
<dt id="underworld.swarm.SwarmAbstract.stateId">
<code class="descname">stateId</code><a class="headerlink" href="#underworld.swarm.SwarmAbstract.stateId" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">Swarm state identifier. This is incremented whenever the swarm is
modified.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">int</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="underworld.swarm.SwarmAbstract.variables">
<code class="descname">variables</code><a class="headerlink" href="#underworld.swarm.SwarmAbstract.variables" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">List of swarm variables associated with this swarm.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">list</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="underworld.swarm.layouts.html" class="btn btn-neutral float-right" title="underworld.swarm.layouts module" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="underworld.utils.html" class="btn btn-neutral" title="underworld.utils module" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016, Melbourne University, Monash University..

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>